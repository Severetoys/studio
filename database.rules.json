
{
  "rules": {
    // Default rule: Deny read and write for all paths by default.
    // Access via the Admin SDK (used in your admin panel) bypasses these rules.
    ".read": false,
    ".write": false,

    "facialAuth": {
       "users": {
          // Allow public read of user data, necessary for the AI verification process.
          ".read": true,
           // Writing here will also be done by the server, which already has admin access.
          ".write": false
       }
    },

    // All other top-level collections are read-only for the public.
    // Writing is blocked from the client.
    "admin": {
      ".read": false,
      ".write": false
    },
    "payments": {
      ".read": false,
      ".write": false
    },
    "reviews": {
      ".read": true,
      ".write": false
    },
    "products": {
      ".read": true,
      ".write": false
    },
    "photos": {
      ".read": true,
      ".write": false
    },
    "videos": {
      ".read": true,
      ".write": false
    },

    // Rules for the secret chat feature
    "chats": {
      // An authenticated user (including anonymous ones) can access a specific chat.
      "$chatId": {
        ".read": "auth != null",
        ".write": "auth != null",
        // Index messages by timestamp for ordering.
        "messages": {
          ".indexOn": ["timestamp"]
        }
      }
    }
  }
}
